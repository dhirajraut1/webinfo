<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <!-- leaflet cdn -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""></script>

    <!-- Load Esri Leaflet from CDN -->
    <script src="https://unpkg.com/esri-leaflet@2.2.3/dist/esri-leaflet.js"
        integrity="sha512-YZ6b5bXRVwipfqul5krehD9qlbJzc6KOGXYsDjU9HHXW2gK57xmWl2gU6nAegiErAqFXhygKIsWPKbjLPXVb2g=="
        crossorigin=""></script>


    <!-- Load Esri Leaflet Geocoder from CDN -->
    <link rel="stylesheet" href="https://unpkg.com/esri-leaflet-geocoder@2.2.13/dist/esri-leaflet-geocoder.css"
        integrity="sha512-v5YmWLm8KqAAmg5808pETiccEohtt8rPVMGQ1jA6jqkWVydV5Cuz3nJ9fQ7ittSxvuqsvI9RSGfVoKPaAJZ/AQ=="
        crossorigin="">
    <script src="https://unpkg.com/esri-leaflet-geocoder@2.2.13/dist/esri-leaflet-geocoder.js"
        integrity="sha512-zdT4Pc2tIrc6uoYly2Wp8jh6EPEWaveqqD3sT0lf5yei19BC1WulGuh5CesB0ldBKZieKGD7Qyf/G0jdSe016A=="
        crossorigin=""></script>
    <title>Your Infos</title>
    <style>
        #map {
            height: 400px;
            width: 800px;
        }
    </style>
</head>

<body>
    <header class="bg-primary">
        <div>
            <h1 class="text-center text-white">YOUR INFORMATION</h1>
        </div>
    </header>
    <section>
        <div class="container">
            <div class="row">
                <div class="col">
                    <h4 class="text-danger"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                            fill="currentColor" class="bi bi-geo-alt-fill" viewBox="0 0 16 16">
                            <path
                                d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z" />
                        </svg> Please allow location permission to view your current position.</h4><br>
                    <p>This website is designed to show various informations that can be
                        gathered by different websites including your:
                    <ul>
                        <li>current GPS Location</li>
                        <li>IP Address</li>
                        <li>Browser Information</li>
                        <li>Operating System</li>
                        <li>Intenet Service Provider</li>
                        <li>and so on.</li>
                    </ul>
                    </p>
                </div>
            </div>
        </div>
    </section>

    <section class="pt-5 pb-5">
        <div class="container">
            <div class="row">
                <div class="col">
                    <table class="table">
                        <thead>
                            <tr class="table-warning">
                                <th scope="col"></th>
                                <th scope="col">GPS Location</th>
                                <th scope="col">IP Address</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="table-info">
                                <td scope="row">Latitude</td>
                                <td id="geolat"></td>
                                <td id="iplat"></td>
                            </tr>
                            <tr class="table-secondary">
                                <td scope="row">Longitude</td>
                                <td id="geolng"></td>
                                <td id="iplng"></td>
                            </tr>
                            <tr class="table-info">
                                <td scope="row">Address</td>
                                <td id="geoadd"></td>
                                <td id="ipadd"></td>
                            </tr>
                        </tbody>
                    </table>
                    <br>
                    <table class="table">
                        <thead>
                            <tr class="table-warning">
                                <th scope="col">IP Address</th>
                                <th scope="col">ISP</th>
                                <th scope="col">Browser</th>
                                <th scope="col">OS</th>
                                <!-- <th scope="col">Device</th> -->
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="table-info">
                                <td id="ip">IP Address</td>
                                <td id="isp"></td>
                                <td id="browser"></td>
                                <td id="os"></td>
                                <!-- <td id="device"></td> -->
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>
    <section>
        <div class="container">
            <div class="row">
                <div class="col d-flex justify-content-center">
                    <div id="map"></div>
                </div>
            </div>
            <p class="pt-4 text-success"><em><strong> Further functionalities will be added to the website very
                        soon.</strong></em>
            </p>
        </div>
    </section>
</body>

</html>
<script>
    var map = L.map('map').setView([27.7172, 84.1240], 14); // set map center and zoom

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    });
    googleHybrid = L.tileLayer('http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}', {
        maxZoom: 20,
        subdomains: ['mt0', 'mt1', 'mt2', 'mt3']
    }).addTo(map);
    // getting the user's location using the geolocation API and GPS
    if (!navigator.geolocation) {
        alert('Geolocation is not supported by your browser');
    } else {
        navigator.geolocation.getCurrentPosition(function (position) {
            var lat = position.coords.latitude;
            var lng = position.coords.longitude;
            var accuracy = position.coords.accuracy;
            // L.marker([lat, lng]).addTo(map)
            //     .bindPopup('Your location is: ' + lat + ',' + lng + '<br>Accuracy: ' + accuracy + 'm')
            //     .openPopup();
            var circle = L.circle([lat, lng], {
                color: 'red', radius: accuracy
            }).addTo(map);

            // reverse geocoding
            var geocodeService = L.esri.Geocoding.geocodeService();
            geocodeService.reverse().latlng([lat, lng]).run(function (error, result) {
                if (error) {
                    return;
                }
                L.marker(result.latlng).addTo(map).bindPopup("Your location as per GPS is:" + "<br>" + result.address.Match_addr).openPopup();
                document.getElementById("geoadd").innerHTML = result.address.Match_addr;    // display the address
                map.fitBounds(circle.getBounds()); // fit the map to the circle
            });

            //printing the user's location
            document.getElementById("geolat").innerHTML = lat;
            document.getElementById("geolng").innerHTML = lng;
        });
    }
    // IP RELATED INFORMATION
    fetch('https://ipapi.co/json/')
        .then(function (response) {
            return response.json();
        })
        .then(function (data) {
            // console.log(data);
            document.getElementById("iplat").innerHTML = data.latitude;
            document.getElementById("iplng").innerHTML = data.longitude;
            document.getElementById("ipadd").innerHTML = data.city + ", " + data.region + ", " + data.country;
            // document.getElementById("ip").innerHTML = "Your IP Address is: " + data.ip;
            document.getElementById("isp").innerHTML = data.org;
        });
</script>

<!------------------------------------------------------->
<!------------------FOR IP ADDRESS ---------------------->
<!------------------------------------------------------->
<script>
    function getIP(json) {
        document.getElementById("ip").innerHTML = json.ip;
    }</script>
<script src="https://api.ipify.org?format=jsonp&callback=getIP"></script>

<!-- as seperate script tag -->
<script type="application/javascript" src="https://api.ipify.org?format=jsonp&callback=getIP"> </script>

<!------------------------------------------------------->
<!-----------FOR OS, BROWSER and DEVICE ----------------->
<!------------------------------------------------------->
<script>
    var OSName = "Unknown OS";
    if (navigator.appVersion.indexOf("Win") != -1) OSName = "Windows";
    if (navigator.appVersion.indexOf("Mac") != -1) OSName = "MacOS";
    if (navigator.appVersion.indexOf("X11") != -1) OSName = "UNIX";
    if (navigator.appVersion.indexOf("Linux") != -1) OSName = "Linux";
    document.getElementById("os").innerHTML = OSName;



    // FOR BROWSER
    var nVer = navigator.appVersion;
    var nAgt = navigator.userAgent;
    var browserName = navigator.appName;
    var fullVersion = '' + parseFloat(navigator.appVersion);
    var majorVersion = parseInt(navigator.appVersion, 10);
    var nameOffset, verOffset, ix;

    // In Opera, the true version is after "Opera" or after "Version"
    if ((verOffset = nAgt.indexOf("Opera")) != -1) {
        browserName = "Opera";
        fullVersion = nAgt.substring(verOffset + 6);
        if ((verOffset = nAgt.indexOf("Version")) != -1)
            fullVersion = nAgt.substring(verOffset + 8);
    }
    // In MSIE, the true version is after "MSIE" in userAgent
    else if ((verOffset = nAgt.indexOf("MSIE")) != -1) {
        browserName = "Microsoft Internet Explorer";
        fullVersion = nAgt.substring(verOffset + 5);
    }
    // In Chrome, the true version is after "Chrome" 
    else if ((verOffset = nAgt.indexOf("Chrome")) != -1) {
        browserName = "Chrome";
        fullVersion = nAgt.substring(verOffset + 7);
    }
    // In Safari, the true version is after "Safari" or after "Version" 
    else if ((verOffset = nAgt.indexOf("Safari")) != -1) {
        browserName = "Safari";
        fullVersion = nAgt.substring(verOffset + 7);
        if ((verOffset = nAgt.indexOf("Version")) != -1)
            fullVersion = nAgt.substring(verOffset + 8);
    }
    // In Firefox, the true version is after "Firefox" 
    else if ((verOffset = nAgt.indexOf("Firefox")) != -1) {
        browserName = "Firefox";
        fullVersion = nAgt.substring(verOffset + 8);
    }
    // In most other browsers, "name/version" is at the end of userAgent 
    else if ((nameOffset = nAgt.lastIndexOf(' ') + 1) <
        (verOffset = nAgt.lastIndexOf('/'))) {
        browserName = nAgt.substring(nameOffset, verOffset);
        fullVersion = nAgt.substring(verOffset + 1);
        if (browserName.toLowerCase() == browserName.toUpperCase()) {
            browserName = navigator.appName;
        }
    }
    // trim the fullVersion string at semicolon/space if present
    if ((ix = fullVersion.indexOf(";")) != -1)
        fullVersion = fullVersion.substring(0, ix);
    if ((ix = fullVersion.indexOf(" ")) != -1)
        fullVersion = fullVersion.substring(0, ix);

    majorVersion = parseInt('' + fullVersion, 10);
    if (isNaN(majorVersion)) {
        fullVersion = '' + parseFloat(navigator.appVersion);
        majorVersion = parseInt(navigator.appVersion, 10);
    }
    document.getElementById("browser").innerHTML = browserName;


    // FOR DEVICE
    // const getDeviceType = () => {
    //     const ua = navigator.userAgent;
    //     if (/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(ua)) {
    //         return "tablet";
    //         document.getElementById("device").innerHTML = "tablet";
    //     }
    //     if (/Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(ua)) {
    //         return "mobile";
    //         document.getElementById("device").innerHTML = "Mobile";
    //     } else {
    //         // return "desktop";
    //         document.getElementById("device").innerHTML = "Desktop";
    //     }
    //     // return "desktop";
    //     document.getElementById("device").innerHTML = "Desktop";
    // };
</script>